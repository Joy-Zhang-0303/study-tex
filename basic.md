TeXの基本・簡単な扱い方
===========
TeXの基本的なやつまとめ

- [TeXとは](#about)
- [インストール](#install)
- [書く](#intro)
- [エディタ](#editor)


<a name="about"></a>
TeXとは
-----------
TeXは1978年に開発された組版システム（typesetting system）です。
より具体的には、マークアップによって記述された文章から版を組むソフトウェア群です。
マークアップで文章を作成できるため、機械的に処理したり文章を汎用化したりするのが楽であり、
何よりクロスプラットフォームのOSSということで進化を続けています。
モノがモノですから情報系を始めとする理数系に好まれており、
論文や技術文書を書くための進化は特に著しいものとなっています。

LaTeXとは
-----------
LaTeXって何なんですか。正直分かりません。
訳分かりませんが、現在「テック」と言った場合はこのLaTeXのことを指すことが多いです。
というかTeXそのものについて話をすることはあまりないでしょう。
viとvimのような関係だと思います。
LateX2eというのはLaTeXの最新版(2016年1月現在)のことだそうです。
次バージョンは3が予定されているとか。

詳しくは[ここ](https://oku.edu.mie-u.ac.jp/~okumura/texwiki/?LaTeX "LaTeX - TeX Wik")をチェキだ！
とても分かりやすく書いてあります。


### 豆知識：発音に関して
TeXを素直に読むとテックス(/tecks/)ですが、
TeXの開発者Donald E. Knuthの著書「The TeXbook」によると
"TEX"の文字はアルファベットではなく
ギリシャ文字のタウ・イプシロン・カイの大文字から取っているらしいです。
ということで発音も一味あるという設定らしいですが、
そんなこと言われても日本でカタカナに興すときに困ります。
特にカイの部分の発音に一悶着ございまして、ざっと発音の一覧を書くと以下のようになります。

|       | 日本語                       | 英語               |
|-------|------------------------------|--------------------|
| TeX   | テック、テックス、テフ       | teck, tecks        |
| LaTeX | ラテック、レイテック、ラテフ | la-teck, lei-tecks |

ところで、上記の「The TeXbook」の練習問題1.1である

> After you have mastered the material in this book, what will you be: A TeXpert, or a TeXnician?

の解答は

> A TeXnician (underpaid); sometimes also called a TeXacker.

となっています。問題は後者で、"TeXacker"は「テック・ハッカー」ですね。
これが"TE-F\*cker"とか"TECK-S\*cker"とかなっちゃうとちょっと意味通らない以前にアレになりますね。
ということで「テック」と呼ぶのが無難だと思うぞ！


<a name="install"></a>
インストール
-----------
TeX/LaTeXはクロスプラットフォームのソフトウェアなので、
Windows, OSX, Linux, BSDなどほとんどのOS上で動きます。
ということで、分かる範囲でTeX/LaTeX（の処理系？）のインストールについて書いていきます。

- OSX
	- [MacTeX](http://qiita.com/hideaki_polisci/items/3afd204449c6cdd995c9)
		便利なツールやよく使うパッケージがついててお得。ただ量がすごい。
	- [BasicTeX](http://qiita.com/yyamnk/items/2da2791bcee82643984f)
		「MacTeX重いわ」「無駄多いで」という人にはbasicTeX。
		私はこっち使ってます（私が誰か気になったらblameしてね）。
		basicTeXにtlmgrで必要になったパッケージを追加していくスタイル。


<a name="intro"></a>
書く
-----------
インストールは済んだでしょうか。
細かい環境設定はまあ置いておいて、早速TeXを書いてみましょう。
体で覚えるというゴリラ戦法です。

### ハローワールド的な

```tex
\documentclass{jsarticle}
\begin{document}
この文章はLaTeXを用いています。

LaTeXを使う意味について

1. 読みやすいレイアウト
2. 数式を書きやすい
3. クロスプラットフォーム
4. OSS
\end{document}
```

ここからはお手元の環境によりますが、今回はシェル上の操作とします。
ではシェルを起動して、適当なディレクトリに移動してください。
上のtexコードを`practice.tex`として保存したら、早速コンパイルしましょう。

```sh
platex practice.tex
```

このコマンドを打つとなんかヴェアアって出力されて
`practice.log`、`practice.aux`、`practice.dvi`というファイルが生成されます。
これはそれぞれ
`.log`はplatexのビルドログ、
`.aux`は次のビルドの為の補助（auxiliary）ファイル、
`.dvi`は文書だと思っていただいて大丈夫です。
dviは "Device Independent File" の意味で、
出力デバイスに依存しない形式の版の状態です。
auxはlabelやciteなどのクロスリファレンスに使われるのですが、
これらは後でのお楽しみ。
ビルドログにはエラーメッセージなど重要な情報が載っていますので、
この先困ったらコイツを確認するようにしましょう。

細かいことは後回しにして（気になったら[Webリンク](links.md)なんかもチェキしていただいて）、
このdviを出力形式に変換するわけですが、
これは基本的にPDFに出力するものだと思っていただいて結構です。
「あーTeXをこのDTPの形式に出力できないかなー」となったときにdviからの変換ができないか調べる、
という考え方でいいと思います。

dviファイルをpdfに出力するにはdvipdfmxというソフトウェアを使います。

```sh
dvipdfmx practice.dvi
```

ちなみに、platex、dvipdfmxともに拡張子は省略できます。
気持ち悪いですがシェルスクリプトなどで自動化する際は拡張子をいちいち弄らなくて済むので楽です（でもやっぱり明示しないと気持ち悪いです）。

話は戻して、このコマンドを実行すると肝心なpdfが作成されているものと思います。
こんな感じのpdfが出力されていたらオーケーです。

![practice.1](basic/images/practice.1.png)

ちなみに、これら二つのコマンドを連続して実行するものとして、ptex2pdfというものがあります。
オプションなど詳しくは[こちら](http://oku.edu.mie-u.ac.jp/~okumura/texwiki/?ptex2pdf)を参考に。

```sh
ptex2pdf -l practice.tex
```

### いい感じにする

さて、作成されたpdfですが、なんだかコレジャナイ感がありますね。
このイケてない文書をイケてる文書にするために以下の要件を用意しましょう。

1. "LaTeX"の文字をLaTeXのロゴにしたい
2. 二行目の内容をタイトルっぽくしたい
3. 数字付き箇条書きをそれぽっぽくしたい

それでは最初から。

```tex
\documentclass{jsarticle}
\begin{document}
この文章は \LaTeX を用いています。

LaTeXを使う意味について

1. 読みやすいレイアウト
2. 数式を書きやすい
3. クロスプラットフォーム
4. OSS
\end{document}
```

"LaTeX"の文字列にバックスラッシュ（環境によっては円マークでも大丈夫です）を入れました。
注意として、今回はうしろに空白を入れるようにしてください。

![practice.2](basic/images/practice.2.png)

文書中のバックスラッシュを追加した部分がLaTeXのロゴになっています。
TeXには **シンボル** というものが用意されています。
copyrightのマルC記号や、トレードマークなどの記号がこれに値します。
うしろに空白を入れたのは、この形式のシンボルには閉じ記号がないため、
区切りとして空白を必要とするためです。
ナチュラルに空白を入れる英文なら気にかける必要ないんですけどね。

次に二行目をタイトルっぽくしてみます。

```tex
\documentclass{jsarticle}
\begin{document}
この文章は \LaTeX を用いています。

\section{\LaTeX を使う意味について}

1. 読みやすいレイアウト
2. 数式を書きやすい
3. クロスプラットフォーム
4. OSS
\end{document}
```

![practice.3](basic/images/practice.3.png)

ついでにLaTeXをロゴにしました。

このようにsectionというものを使うと、
レポートや技術書によくある章・節・項を扱うことができます。
基本的に、章はsection、節はsubsection、項はsubsubsectionとなります。

最後に数字付き箇条書きをしましょう。

```tex
\documentclass{jsarticle}
\usepackage{enumitem}
\begin{document}
この文章は \LaTeX を用いています。

\section{\LaTeX を使う意味について}
\TeX を使うと、以下のような利点があります。

\begin{enumerate}
  \item 読みやすいレイアウト
  \item 数式を書きやすい
  \item クロスプラットフォーム
  \item OSS
\end{enumerate}
\end{document}
```

![practice.4](basic/images/practice.4.png)

数字付き箇条書きにはenumerateという **環境** を使いますが、
今回は標準のenumerateを拡張する **パッケージ** であるenumitemを使ってみました。

二つ新しい用語が出ましたが、まずパッケージについて紹介します。
TeXの基本的な機能を拡張し、
組版やTeXの書き方をいいカンジにするための拡張を **パッケージ**
といいます。
パッケージを利用するには、`\usepackage`コマンドを利用します。
このコマンドによって、
組版の際に
「パッケージマネージャによって管理されている範囲」
「組版時にいるディレクトリ」
から指定されたスタイルファイルを読み込み、拡張を行います。
スタイルファイルについては後述とさせていただきます。

とりあえず考えるのは、前者の「パッケージマネージャによって管理されている範囲」です。
[インストールの項目](#install)を終えると、
platexなどの組版ソフトと一緒に`tlmgr`というソフトが入っていると思います。
これは「**T**eX**L**ive Package **M**ana**g**e**r**」の略なのですが、
どう読めばいいんですかね。
私はテルムグラとかトリモゲラとか意味わからない読み方をしています。
今回インストールしたTeXの処理系は、実は「TeXLive」というディストリビューションで、
`tlmgr`はそのパッケージマネージャとなっています。
このパッケージマネージャを使って、
公開されているスタイルをインストールして扱うことができます。

さて、今回のtexファイルをビルドしてみてください。
enumitemがundefinedだからnot foundだかというエラーが返ってくる場合があります。
これはenumitemパッケージをまだインストールしていないためです。
basicTeXなんかだと入っていません。
ということでtlmgrを使って入れてみましょう。

```
tlmgr install enumitem
```

これだけで済みます。
簡単ですね。
うまくいかなかった場合はメッセージを読んで解決してください。
たいていupdateしろとかそんなんです。
さて、インストールが済んだのでもう一度ビルドしてみてください。
今度は何も文句を言われないと思います。
このように、
こんな組版が使いたいなあと思って
パッケージを利用する必要ができたら、
パッケージマネージャを利用すると便利です。

次に、環境です。
今、情報系なあなたなら、`\begin`で始まり`\end`で終わる一つの塊を見ていると思います。
この囲まれた範囲はenumerateの **環境** にあるという言い方をします。
enumerate環境下では`\item`というシンボルを用いて箇条書きを行うことができます。

TeXの大切な利点を忘れていました。
自動的に処理すべき文書を自動生成してくれることはTeXの大きな利点の一つです。
「文書の自動生成」は二番目にインパクトのある魅力ですから、
上から二番目にこの項目を追加しましょう。

```tex
\documentclass{jsarticle}
\usepackage{enumitem}
\begin{document}
この文章は \LaTeX を用いています。

\section{\LaTeX を使う意味について}
\TeX を使うと、以下のような利点があります。

\begin{enumerate}
  \item 読みやすいレイアウト
  \item 文書の自動生成
  \item 数式を書きやすい
  \item クロスプラットフォーム
  \item OSS
\end{enumerate}
\end{document}
```

![practice.4-2](basic/images/practice.4-2.png)

このように、
enumerate環境を用いると箇条書きに添える番号は自動的に付与してくれます。
今となってはそれほど珍しい機能ではありませんが、
TeXは私たちが1,2,3の項目を作成してから1と2の間に項目を挿入したくなった時、
挿入した項目以降の添字をいちいちずらすような滑稽な真似はさせません。

自動的な生成について、ここでもう少し触れておきたいと思います。


### ラベルと参照

`.aux`ファイルのときにも少し触れましたが、TeXには参照（referencing）という機能があります。
百聞は一見に如かずということでやってみましょう。

```tex
\documentclass{jsarticle}
\usepackage{enumitem, here}
\begin{document}
この文章は \LaTeX を用いています。

\section{\LaTeX を使う意味について}
\TeX を使うと、以下のような利点があります。

\begin{enumerate}
  \item 読みやすいレイアウト
  \item 文書の自動生成
  \item 数式を書きやすい
  \item クロスプラットフォーム
  \item OSS
\end{enumerate}

\subsection{\TeX /\LaTeX の発音}
\TeX 、\LaTeX の発音を簡単にまとめると表\ref{tab:test}のようになる。

\begin{table}[H]
  \centering
  \caption{\TeX /\LaTeX の発音}
  \label{tab:test}
  \begin{tabular}{l|l|l}
    \hline
    & 日本語 & 英語 \\
    \hline
    \TeX & テック、テックス、テフ & teck, tecks \\
    \LaTeX & ラテック、レイテック、ラテフ & la-teck, lei-tecks \\
    \hline
  \end{tabular}
\end{table}
\end{document}
```

![practice.5](basic/images/practice.5.png)

TeXでは表、画像、ソースリストなどには自動的に番号が振られ、
目印（label）を用いて、その番号を参照することができるのです。
この際、どの表や画像にどの番号が振られているのを記録するのが`.aux`ファイルの役割です。

上の画像では表番号の参照がうまくいっていません。
あなたの画面上でも同様の表示となっていると思われますが、
これはdviの生成時に、参照するべき`.aux`ファイルが存在しないためです。

一度コンパイルするともう`.aux`ファイルは生成されていますから、
もう一度コンパイルして表示してみましょう。

![practice.5-2](basic/images/practice.5-2.png)

今度はうまく番号が参照されました。

`.aux`はクロスリファレンスに使われると前述しましたが、
「クロス」リファレンスはお察しの通りファイルをまたぐことのできる参照です。
texは一つのファイルに長々と記述するだけでなく
`\input`や`\include`コマンドを用いてファイル分割ができるのですが、
この場合、別の場所で定義される表や図などに対しても参照はちゃんと機能するようになっています。

最後に、ラベルには型がありません。
ラベルは表、数式、図やリストなどあらゆる環境に埋め込んで参照を行うことができますが、
表のラベル`\label{data}`に対して「図`\ref{data}`によると...」という文章を許せるのです。
これを不便に感じるために、ラベル名の頭になんのラベルなのかを示唆する習慣があります。
この習慣は、例えば以下のような書き方をします。

| 環境       | ラベル      |
|------------|-------------|
| table      | tab:hoge    |
| figure     | fig:hoge    |
| equation   | eq:hoge     |
| lstlisting | lst:hoge    |
| chapter    | ch:hoge     |
| section    | sec:hoge    |
| subsection | subsec:hoge |
| enumerate  | itm:hoge    |
| appendix   | app:hoge    |
| algorithm  | alg:hoge    |


測定結果の表に対してそれをまとめたグラフを作成するなんていうことはザラにあると思いますが、
これを「表`\ref{tab:somedata}`の結果を`\ref{fig:somedata}`にまとめた」と命名することができます。
これはイケています。


### 数式の記述

LaTeXを利用する大きな理由として、数式の利用しやすさがあります。

```tex
\documentclass[a4j]{jsarticle}
\usepackage{amsmath}
\begin{document}
\begin{align}
  \label{eq:norm}
  f(x) &=
  \frac{1}{\sqrt{2\pi} \sigma}
  e^{-\frac{(x-\mu)^2}{2\sigma^2}}
  \\
  \nonumber
  \sigma^2 &=
  \frac{1}{n-1}
  \sum_{i=1}^n
  (X_i - \overline{X})^2
\end{align}
\end{document}
```

![practice.6](basic/images/practice.6.png)

数式の利用にはamsmathパッケージの利用を推奨します。
使わなくてもequation環境、eqnarray環境が標準で用意されていますが、
amsmathパッケージはAMS（アメリカ数学会）がスポンサーとなって拡張したパッケージで、
数学記号や数式表現の改善がされています。

数式を利用する際は`\symbol{argument}`のような形で使用することが多いと思います。
数学記号と、それに関する値です。例えば、(1)式の平方根は`\sqrt{2\pi}`となっています。
これは、円周率のシンボル`\pi`を使い、平方根の中身を`{}`の中に指定しています。

`\sigma^2`のようにするとシグマの自乗を表現することができます。
これをさらに、(1)式の`e^{-\frac{...}{...}}`のように`{}`でくくることで
指数の表現を広げることができます。`{}`がないものは省略形で、
右に続くトークンのみを指数とします。
`frac`はfraction（分数）を作るコマンドで、分子、分母の順に引数を与えます。

そろそろ規則性が見えてきたのではないでしょうか。
細かいシンボルの仕様などはおいておいて、だいたい理解していただけたかと思います。

amsmathには数学記号として使えるさまざまなシンボルや数式表現が用意されています。
詳しくは、AMSの[amsmathのページ](http://www.ams.org/publications/authors/tex/amslatex)から
"amsmath user's guide"か"Short Math Guide for LaTeX"をダウンロードしておくと
使う時に便利だと思います。

`$...$`のようにダラーで囲まれた範囲はインラインの数式表現であると認識されます。
文中で数式表現を行いたい時はこれを使いましょう。

```tex
\documentclass[a4j]{jsarticle}
\usepackage{amsmath}
\begin{document}
正規分布の分布曲線の式は、平均$\mu$と標準偏差\(\sigma\)を用いて、
式\ref{eq:norm}のように表現できる。
```

`\(...\)`も同様に使うことができます。が、もちろん統一したほうがいいです。
私は一文字で表現できるのでダラーが好きです。ダラーにしよう。ダラー推奨です！

（ちなみに$が修飾子になっているせいでlstlisting環境内プロンプトに$使おうとすると
vimの標準texパーサが狂ってシンタックスハイライトがどえらいことになるという愚痴がある）


<!--
### 参考文献

bibについて書くかも
-->


<!--
### プリアンブルとスタイルファイル

これで最後じゃ
-->


### 他マークアップ言語からの変換
- [org-mode](http://orgmode.org/ja/)
- Markdown


<a name="identity"></a>
TeXのいいトコ悪いトコ
-----------
基本的な文書を書けるような内容は舐めたと思うので、
このあたりでTeXの強みと弱みを軽く見ていきたいと思います。

- 強み
	- プレーンテキストなので管理が楽
		特にVCSの管理下に置いてリビジョンを管理したいとき、
		grepを行いたいときなどにプレーンテキストなのが助かります。
	- 分割管理
		文書が大きくなっても分割管理をすることができることは強みです。
		我々の部誌で言うと、inputコマンド1行をコメントアウトするだけで
		記事の切り離しができます。
		ソースコードや画像の貼り付けをする際も、
		分割管理をすれば組版前の状態を読みやすく保つことができます。
- 弱み
	- グラフィカルな操作がだるい
		文章に視覚的なインパクトを与えるために、
		めちゃくちゃな位置に文を設置したり
		縦横無尽に矢印を配置したりしたいことがあるかもしれません。
		そんなときTeXは面倒くさい方法をとらないとやりたいことが実現できないかもしれません。

ですが、この弱みというのは些細な問題ではありません。
TeXで作成するのは意味ごとに区切られ整理された文章ですので、
そういったグラフィカルな部分は文字どおり画像で管理されるべきです。

また、グラフィカルなDTPソフトと比べて学習コストが高いという指摘がありますが、
そうでもないと思います。
実際、変態的な応用をしようと思わない限り、
これまでの内容でTeXのできるおよそのことは習得できています。
応用をするとしても、
隠し機能だなんだという本が出るような突拍子もない方法をとらせるうんちGUIソフトウェアと違い、
TeXの拡張は理解しやすく扱いやすいものが多いです。
これは、その本質がマークアップであることに由来します。
マークアップを書けるなら特に困らないと思います。

<a name="editor"></a>
エディタ
-----------
リアルタイムプレビューとかできるGUIエディタがあるぞ！知らんけど

- [Yet Another TeX mode](https://www.yatex.org)
